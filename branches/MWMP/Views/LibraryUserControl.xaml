<UserControl
	xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
	xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
	xmlns:System="clr-namespace:System;assembly=mscorlib"
    xmlns:local="clr-namespace:MWMP"
    xmlns:converter="clr-namespace:MWMP.Models.Converter"
	xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity" xmlns:ei="http://schemas.microsoft.com/expression/2010/interactions"
	mc:Ignorable="d"
	x:Class="MWMP.LibraryUserControl"
	x:Name="UserControl">
    <UserControl.Resources>
        <converter:MilisecondsToStringConverter x:Key="msToStringConverter"/>
        <ObjectDataProvider MethodName="GetService" ObjectType="{x:Type local:ModuleManager}" x:Key="LibraryViewModel">
            <ObjectDataProvider.MethodParameters>
                <System:String>GlobalLibrary</System:String>
            </ObjectDataProvider.MethodParameters>
        </ObjectDataProvider>
    </UserControl.Resources>
	<UserControl.Background>
		<ImageBrush ImageSource="pack://siteoforigin:,,,/Views/bg_library.jpg" Stretch="UniformToFill"/>
	</UserControl.Background>
    <StackPanel Orientation="Horizontal">
		<TreeView Background="{x:Null}" BorderThickness="0">
			<TreeViewItem Header="Music" IsExpanded="True" Background="{x:Null}">
				<StackPanel Orientation="Horizontal">
					<TextBlock><Run Text="Title :"/></TextBlock>
                    <TextBox DataContext="{Binding MusicLibrary, Source={StaticResource LibraryViewModel}}" Text="{Binding Title}" Margin="0,0,-0.001,0" Width="75" x:Name="TitleMusicFilter">
                    	<i:Interaction.Triggers>
                    		<i:EventTrigger EventName="TextChanged">
                                <i:InvokeCommandAction Command="{Binding SetTitleFilter}" CommandParameter="{Binding ElementName=TitleMusicFilter, Path=Text}"/>
                    		</i:EventTrigger>
                    	</i:Interaction.Triggers>
                    </TextBox>
				</StackPanel>
				<Label Content="Artist"/>
				<Label Content="Genre"/>
			</TreeViewItem>
		</TreeView>
		<StackPanel>
			<ListView ItemsSource="{Binding FilteredMediaList}"
				SelectedItem="{Binding SelectedItem, Mode=OneWayToSource}" ButtonBase.Click="ListView_Sort" x:Name="MusicList" Background="{x:Null}" Foreground="Black">
				<i:Interaction.Triggers>
					<i:EventTrigger EventName="MouseDoubleClick">
                        <i:InvokeCommandAction Command="{Binding PlayContextMenu}" />
					</i:EventTrigger>
				</i:Interaction.Triggers>
				<ListView.DataContext>
					<Binding Path="MusicLibrary" Source="{StaticResource LibraryViewModel}"/>
				</ListView.DataContext>
				<ListView.View>
					<GridView>
						<GridViewColumn Header="Title"     DisplayMemberBinding="{Binding Title}" />
						<GridViewColumn Header="Album"     DisplayMemberBinding="{Binding Album}" />
						<GridViewColumn Header="Track"     DisplayMemberBinding="{Binding Track}" />
						<GridViewColumn Header="Genre"     DisplayMemberBinding="{Binding Genre}" />
						<GridViewColumn Header="Performer" DisplayMemberBinding="{Binding Performers}" />
						<GridViewColumn Header="Duration"  DisplayMemberBinding="{Binding Duration, Converter={StaticResource msToStringConverter}}" />
					</GridView>
				</ListView.View>
				<ListView.ContextMenu>
					<ContextMenu>
						<MenuItem Header="Play" Command="{Binding PlayContextMenu}"/>
						<MenuItem Header="Add to current playlist" Command="{Binding AddToPlayList}" />
						<MenuItem Header="Delete" Command="{Binding DeleteContextMenu}"/>
					</ContextMenu>
				</ListView.ContextMenu>
			</ListView>
			<ListView ItemsSource="{Binding MediaList}" SelectedItem="{Binding SelectedItem, Mode=OneWayToSource}" Background="{x:Null}" Foreground="Black">
                <i:Interaction.Triggers>
                    <i:EventTrigger EventName="MouseDoubleClick">
                        <i:InvokeCommandAction Command="{Binding PlayContextMenu}" />
                    </i:EventTrigger>
                </i:Interaction.Triggers>
                <ListView.DataContext>
					<Binding Path="VideoLibrary" Source="{StaticResource LibraryViewModel}"/>
				</ListView.DataContext>
				<ListView.View>
					<GridView>
						<GridViewColumn Header="Title"     DisplayMemberBinding="{Binding Title}" />
						<GridViewColumn Header="Duration"  DisplayMemberBinding="{Binding Duration, Converter={StaticResource msToStringConverter}}" />
					</GridView>
				</ListView.View>
				<ListView.ContextMenu>
					<ContextMenu>
						<MenuItem Header="Play" Command="{Binding PlayContextMenu}"/>
						<MenuItem Header="Add to current playlist" />
						<MenuItem Header="Delete" />
					</ContextMenu>
				</ListView.ContextMenu>
			</ListView>
			<ListView ItemsSource="{Binding MediaList}" 
				SelectedItem="{Binding SelectedItem, Mode=OneWayToSource}" ButtonBase.Click="ListView_Sort" x:Name="PlayListList" Background="{x:Null}" Foreground="Black">
                <ListView.DataContext>
                    <Binding Path="PlayListLibrary" Source="{StaticResource LibraryViewModel}"/>
                </ListView.DataContext>
                <i:Interaction.Triggers>
                    <i:EventTrigger EventName="MouseDoubleClick">
                        <i:InvokeCommandAction Command="{Binding PlayContextMenu}" />
                    </i:EventTrigger>
                </i:Interaction.Triggers>
				<ListView.View>
					<GridView>
						<GridViewColumn Header="Title"     DisplayMemberBinding="{Binding Title}" />
					</GridView>
				</ListView.View>
				<ListView.ContextMenu>
					<ContextMenu>
						<MenuItem Header="Play" Command="{Binding PlayContextMenu}"/>
						<MenuItem Header="Add to current playlist" Command="{Binding AddToPlayList}" />
						<MenuItem Header="Delete" Command="{Binding DeleteContextMenu}"/>
					</ContextMenu>
				</ListView.ContextMenu>
			</ListView>
		</StackPanel>
	</StackPanel>
</UserControl>